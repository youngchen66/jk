<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>K5 è‹±æ–‡å¥å‹éŠæˆ²</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f8ff;
      text-align: center;
      padding: 40px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, button {
      padding: 10px;
      margin: 5px;
      font-size: 16px;
    }
    .sentence-box, .word-bank {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 20px;
      min-height: 60px;
      padding: 10px;
      border: 2px dashed #ccc;
      background: #fafafa;
    }
    .word {
      background: #e0f7fa;
      padding: 8px 12px;
      margin: 5px;
      border-radius: 6px;
      cursor: grab;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <div class="container" id="game-section">
    <h2>âœï¸ çµ„åˆè‹±æ–‡å¥å­</h2>
    <div><strong>æç¤ºï¼š</strong><span id="hint"></span></div>
    <img id="question-img" src="" alt="" style="max-width: 100%; margin-top: 10px;">
    <div id="word-bank" class="word-bank"></div>
    <div id="sentence-box" class="sentence-box" ondragover="event.preventDefault()" ondrop="drop(event)"></div>
    <button onclick="checkSentence()">âœ… ç¢ºèªå¥å­</button>
    <button onclick="speakSentence()">ğŸ”Š æœ—è®€å¥å­</button>
    <button onclick="nextQuestion()">â¡ï¸ ä¸‹ä¸€é¡Œ</button>
    <p id="feedback"></p>
    <p id="progress"></p>
  </div>

  <script>
    let currentIndex = 0;

    const questionBank = [
      { sentence: ["I", "like", "apples"], hint: "æˆ‘å–œæ­¡è˜‹æœ", img: "images/q1.jpg" },
      { sentence: ["She", "has", "a", "cat"], hint: "å¥¹æœ‰ä¸€éš»è²“", img: "images/q2.jpg" },
      { sentence: ["Letâ€™s", "go", "to", "the", "zoo"], hint: "æˆ‘å€‘å»å‹•ç‰©åœ’å§ï¼", img: "images/q100.jpg" },
      { sentence: ["The", "students", "are", "cleaning", "the", "classroom", "together", "this", "morning"], hint: "å­¸ç”Ÿå€‘ä»Šå¤©æ—©ä¸Šä¸€èµ·æ‰“æƒæ•™å®¤", img: "images/q101.jpg" }
    ];

    function loadGame() {
      const q = questionBank[currentIndex];
      document.getElementById("hint").textContent = q.hint;
      document.getElementById("question-img").src = q.img;
      const wordBank = document.getElementById("word-bank");
      wordBank.innerHTML = "";
      document.getElementById("sentence-box").innerHTML = "";
      document.getElementById("feedback").textContent = "";
      [...q.sentence].sort(() => Math.random() - 0.5).forEach(word => {
        const span = document.createElement("span");
        span.className = "word";
        span.draggable = true;
        span.textContent = word;
        span.ondragstart = e => e.dataTransfer.setData("text", word);
        wordBank.appendChild(span);
      });
      updateProgress();
    }

    function drop(e) {
      const word = e.dataTransfer.getData("text");
      if (word) {
        const span = document.createElement("span");
        span.className = "word";
        span.textContent = word;
        document.getElementById("sentence-box").appendChild(span);
      }
    }

    function checkSentence() {
      const correct = questionBank[currentIndex].sentence.join(" ");
      const user = Array.from(document.getElementById("sentence-box").children).map(el => el.textContent).join(" ");
      const feedback = document.getElementById("feedback");
      if (user === correct) {
        feedback.textContent = "ğŸ‰ ç­”å°äº†ï¼";
        feedback.style.color = "green";
      } else {
        feedback.textContent = `âŒ ç­”éŒ¯äº†ï¼Œæ­£ç¢ºç­”æ¡ˆï¼š${correct}`;
        feedback.style.color = "red";
      }
    }

    function nextQuestion() {
      currentIndex++;
      if (currentIndex >= questionBank.length) {
        alert("ğŸ‰ éŠæˆ²å®Œæˆï¼è«‹é‡æ–°é–‹å§‹ã€‚");
        currentIndex = 0;
      }
      loadGame();
    }

    function speakSentence() {
      const sentence = questionBank[currentIndex].sentence.join(" ");
      const utterance = new SpeechSynthesisUtterance(sentence);
      utterance.lang = 'en-US';
      speechSynthesis.speak(utterance);
    }

    function updateProgress() {
      document.getElementById("progress").textContent = `é€²åº¦ï¼šç¬¬ ${currentIndex + 1} é¡Œ / å…± ${questionBank.length} é¡Œ`;
    }

    window.onload = loadGame;
  </script>
</body>
</html>
